<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Physics Sandbox</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
            cursor: crosshair;
        }
        
        #canvas {
            display: block;
        }
        
        #controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 10px;
            color: white;
            user-select: none;
        }
        
        h2 {
            margin-top: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .control-group {
            margin: 10px 0;
        }
        
        label {
            display: inline-block;
            width: 120px;
            font-size: 14px;
        }
        
        input[type="range"] {
            width: 150px;
            vertical-align: middle;
        }
        
        input[type="color"] {
            vertical-align: middle;
        }
        
        button {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            transition: all 0.3s;
        }
        
        button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        #info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            font-size: 12px;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div id="controls">
        <h2> Particle Sandbox</h2>
        
        <div class="control-group">
            <label>Particle Count:</label>
            <input type="range" id="particleCount" min="50" max="500" value="200">
            <span id="countDisplay">200</span>
        </div>
        
        <div class="control-group">
            <label>Explosion Force:</label>
            <input type="range" id="explosionForce" min="5" max="25" value="15" step="0.1">
            <span id="forceDisplay">15</span>
        </div>
        
        <div class="control-group">
            <label>Gravity:</label>
            <input type="range" id="gravity" min="-0.5" max="0.5" value="0.1" step="0.01">
            <span id="gravityDisplay">0.1</span>
        </div>
        
        <div class="control-group">
            <label>Color Mode:</label>
            <select id="colorMode">
                <option value="rainbow">Rainbow</option>
                <option value="fire">Fire</option>
                <option value="ice">Ice</option>
                <option value="galaxy">Galaxy</option>
                <option value="custom">Custom</option>
            </select>
            <input type="color" id="customColor" value="#ff00ff" style="display:none;">
        </div>
        
        <div class="control-group">
            <button id="clearBtn">Clear</button>
            <button id="autoBtn">Auto Mode: OFF</button>
        </div>
    </div>
    
    <div id="info">
        Click anywhere to create explosions! | FPS: <span id="fps">60</span> | Particles: <span id="activeParticles">0</span>
    </div>
    
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        let particles = [];
        let autoMode = false;
        let lastTime = performance.now();
        let fps = 60;
        
        // Control elements
        const particleCountSlider = document.getElementById('particleCount');
        const explosionForceSlider = document.getElementById('explosionForce');
        const gravitySlider = document.getElementById('gravity');
        const colorModeSelect = document.getElementById('colorMode');
        const customColorInput = document.getElementById('customColor');
        const clearBtn = document.getElementById('clearBtn');
        const autoBtn = document.getElementById('autoBtn');
        
        // Display elements
        const countDisplay = document.getElementById('countDisplay');
        const forceDisplay = document.getElementById('forceDisplay');
        const gravityDisplay = document.getElementById('gravityDisplay');
        const fpsDisplay = document.getElementById('fps');
        const activeParticlesDisplay = document.getElementById('activeParticles');
        
        class Particle {
            constructor(x, y, force, color) {
                this.x = x;
                this.y = y;
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * force + force / 2;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
                this.color = color;
                this.size = Math.random() * 3 + 1;
                this.life = 1.0;
                this.decay = Math.random() * 0.02 + 0.005;
                this.trail = [];
                this.maxTrailLength = 10;
            }
            
            update() {
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > this.maxTrailLength) {
                    this.trail.shift();
                }
                
                this.x += this.vx;
                this.y += this.vy;
                this.vy += parseFloat(gravitySlider.value);
                this.vx *= 0.99;
                this.vy *= 0.99;
                this.life -= this.decay;
                
                // Bounce off edges
                if (this.x < 0 || this.x > canvas.width) {
                    this.vx *= -0.8;
                    this.x = Math.max(0, Math.min(canvas.width, this.x));
                }
                if (this.y > canvas.height) {
                    this.vy *= -0.8;
                    this.y = canvas.height;
                }
            }
            
            draw() {
                // Draw trail
                ctx.beginPath();
                this.trail.forEach((point, index) => {
                    const alpha = (index / this.trail.length) * this.life * 0.5;
                    ctx.globalAlpha = alpha;
                    ctx.lineTo(point.x, point.y);
                });
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = this.color;
                ctx.lineWidth = this.size * 0.5;
                ctx.stroke();
                
                // Draw particle
                ctx.globalAlpha = this.life;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // Glow effect
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * 3, 0, Math.PI * 2);
                const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 3);
                gradient.addColorStop(0, this.color + '40');
                gradient.addColorStop(1, this.color + '00');
                ctx.fillStyle = gradient;
                ctx.fill();
                
                ctx.globalAlpha = 1;
            }
            
            isDead() {
                return this.life <= 0;
            }
        }
        
        function getColor() {
            const mode = colorModeSelect.value;
            
            switch(mode) {
                case 'rainbow':
                    const hue = Math.random() * 360;
                    return `hsl(${hue}, 100%, 50%)`;
                case 'fire':
                    const fireHue = Math.random() * 60;
                    return `hsl(${fireHue}, 100%, 50%)`;
                case 'ice':
                    const iceHue = 180 + Math.random() * 60;
                    return `hsl(${iceHue}, 100%, 50%)`;
                case 'galaxy':
                    const galaxyColors = ['#ff00ff', '#00ffff', '#ff00aa', '#aa00ff', '#ffffff'];
                    return galaxyColors[Math.floor(Math.random() * galaxyColors.length)];
                case 'custom':
                    return customColorInput.value;
            }
        }
        
        function createExplosion(x, y) {
            const count = parseInt(particleCountSlider.value);
            const force = parseFloat(explosionForceSlider.value);
            
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, force, getColor()));
            }
        }
        
        function animate(currentTime) {
            const deltaTime = currentTime - lastTime;
            if (deltaTime > 16) {
                fps = Math.round(1000 / deltaTime);
                lastTime = currentTime;
                
                ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                particles = particles.filter(particle => {
                    particle.update();
                    particle.draw();
                    return !particle.isDead();
                });
                
                fpsDisplay.textContent = fps;
                activeParticlesDisplay.textContent = particles.length;
                
                if (autoMode && Math.random() < 0.1) {
                    createExplosion(
                        Math.random() * canvas.width,
                        Math.random() * canvas.height
                    );
                }
            }
            
            requestAnimationFrame(animate);
        }
        
        // Event listeners
        canvas.addEventListener('click', (e) => {
            createExplosion(e.clientX, e.clientY);
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (e.buttons === 1) {
                createExplosion(e.clientX, e.clientY);
            }
        });
        
        particleCountSlider.addEventListener('input', (e) => {
            countDisplay.textContent = e.target.value;
        });
        
        explosionForceSlider.addEventListener('input', (e) => {
            forceDisplay.textContent = e.target.value;
        });
        
        gravitySlider.addEventListener('input', (e) => {
            gravityDisplay.textContent = e.target.value;
        });
        
        colorModeSelect.addEventListener('change', (e) => {
            customColorInput.style.display = e.target.value === 'custom' ? 'inline' : 'none';
        });
        
        clearBtn.addEventListener('click', () => {
            particles = [];
        });
        
        autoBtn.addEventListener('click', () => {
            autoMode = !autoMode;
            autoBtn.textContent = `Auto Mode: ${autoMode ? 'ON' : 'OFF'}`;
            autoBtn.style.background = autoMode ? 'rgba(255, 100, 100, 0.3)' : 'rgba(255, 255, 255, 0.2)';
        });
        
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        
        // Start animation
        animate(performance.now());
        
        // Initial explosion
        setTimeout(() => {
            createExplosion(canvas.width / 2, canvas.height / 2);
        }, 100);
    </script>
</body>
</html>